{% extends "base.html" %}

{% block content %}
<div class="wallet-container">
  <div class="card wallet-card">
    <div class="wallet-header">
      <h1 class="wallet-title">
        💰 Your Wallet
      </h1>
      <p class="wallet-subtitle">Manage your credits and view transaction history</p>
    </div>

    <!-- Current Balance -->
    <div class="wallet-balance-section">
      <div class="wallet-balance-label">💎 Current Balance</div>
      <div class="wallet-balance-amount">
        {{ current_user.mini_word_credits or 0 }}
      </div>
      <div class="wallet-balance-unit">CREDITS</div>
      <div class="wallet-balance-status">
        <span class="wallet-balance-status-text">✓ Ready to use</span>
      </div>

      <!-- War Badge Display -->
      {% if war_badge %}
      <div class="wallet-war-badge" style="background:linear-gradient(135deg, {{ war_badge.theme }}, rgba(255,255,255,0.1));border-color:{{ war_badge.theme }};">
        <div class="wallet-war-badge-title">⚔️ War Champion</div>
        <div class="wallet-war-badge-content">
          <span class="wallet-war-badge-icon">{{ war_badge.icon }}</span>
          <div>
            <div class="wallet-war-badge-name">{{ war_badge.name }}</div>
            <div class="wallet-war-badge-wins">{{ war_badge.wins }} victories</div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Quick Actions -->
    <div class="wallet-actions">
      <a href="/store" class="btn wallet-action-btn">
        💎 Buy More Credits
      </a>
      <a href="/profile" class="btn wallet-action-btn">
        🧑 View Profile
      </a>
    </div>

    <!-- Recent Purchases -->
    {% if purchases %}
    <div class="wallet-section">
      <h3 class="wallet-section-title">🧾 Recent Purchases</h3>
      <div class="wallet-section-scroll">
        {% for purchase in purchases %}
        <div class="wallet-entry">
          <div>
            <div class="wallet-entry-title">{{ purchase.credits }} Credits</div>
            <div class="wallet-entry-date">{{ purchase.created_at.strftime('%b %d, %Y at %I:%M %p') }}</div>
          </div>
          <div class="wallet-entry-right">
            <div class="wallet-entry-amount">${{ "%.2f"|format(purchase.amount_cents/100) }}</div>
            <div class="wallet-entry-status">{{ purchase.status }}</div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Transaction History -->
    {% if transactions %}
    <div class="wallet-section">
      <h3 class="wallet-section-title">📜 Recent Transactions</h3>
      <div class="wallet-section-scroll">
        {% for txn in transactions %}
        <div class="wallet-entry">
          <div>
            <div class="wallet-entry-title">{{ txn.reason or 'Credit Transaction' }}</div>
            <div class="wallet-entry-date">{{ txn.created_at.strftime('%b %d, %Y at %I:%M %p') }}</div>
          </div>
          <div class="wallet-entry-right">
            <div class="{{ 'wallet-transaction-amount-positive' if txn.amount_delta > 0 else 'wallet-transaction-amount-negative' }}">
              {{ '+' if txn.amount_delta > 0 else '' }}{{ txn.amount_delta }} Credits
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Credit Usage Info -->
    <div class="wallet-info-section">
      <h3 class="wallet-info-title">💡 What can you do with credits?</h3>
      <ul class="wallet-info-list">
        <li>🧩 Unlock AI-powered hints during gameplay (1 💎)</li>
        <li>♻️ Continue playing after losing (5 💎)</li>
        <li>🚀 Boost community posts to increase visibility (10 💎)</li>
        <li>⚔️ Challenge other players to Boost Wars</li>
        <li>🏆 Earn War Champion badges through victories</li>
        <li>📈 View detailed transaction history</li>
      </ul>
    </div>

    <!-- Back Navigation -->
    <div class="wallet-nav">
      <a href="/" class="btn wallet-nav-btn">
        🎮 Back to Games
      </a>
    </div>
  </div>
</div>
{% endblock %}