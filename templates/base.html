<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
{% if csrf_token %}<meta name="csrf-token" content="{{ csrf_token }}">{% endif %}
<title>{% block title %}Mini Word Finder{% endblock %}</title>
<link rel="icon" href="/static/images/TheLogo.png">
<link rel="stylesheet" href="{{ url_for('static', filename='css/base.css', v=config.get('ASSET_VERSION')) }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/legal.css') }}?v=1">
</head>
<body data-authenticated="{% if current_user and current_user.is_authenticated %}true{% else %}false{% endif %}">

{% if not hide_everything_except_content %}
<!-- Normal layout: nav, main wrapper, footer -->
<nav class="nav">
<a class="brand" href="/">
<img src="/static/images/TheLogo.png" alt="Logo" />
<span>Mini Word Finder</span>
</a>
<span class="spacer"></span>

    {% block nav_actions %}
      <a href="/guide" class="btn ghost">Guide</a>
      <a href="/community" class="btn ghost">Community</a>
      <a href="/store" id="store-btn" class="btn primary auth-only">ðŸ’Ž Store</a>
      <a href="/wallet" class="btn auth-only">ðŸ’° Wallet</a>
      <a href="/profile" class="btn auth-only">ðŸ§‘ Profile</a>
      {% if current_user and current_user.is_authenticated %}
        <a href="/logout" class="btn secondary auth-only">Logout</a>
      {% else %}
        <a href="{{ url_for('core.login') }}" class="btn secondary">Login</a>
        <a href="{{ url_for('core.register') }}" class="btn primary">Create Account</a>
      {% endif %}
    {% endblock %}
</nav>

<main class="container">
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="{% if category == 'error' %}alert{% else %}success{% endif %}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}
<!-- Content will be injected here by the single block below -->
</main>

{% block footer %}
<footer class="footer">
    <div class="container" style="text-align: center;">
      <strong>Mini Word Finder</strong>
    </div>
  </footer>
{% endblock %}

{% else %}
<!-- Login isolation mode: only flash messages, no nav/footer -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="{% if category == 'error' %}alert{% else %}success{% endif %}" style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 10000;">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}
<!-- Content will be injected here by the single block below -->
{% endif %}

<!-- SINGLE block content declaration - works for both normal and isolated modes -->
{% block content %}{% endblock %}

<script defer src="{{ url_for('static', filename='js/auth-check.js', v=config.get('ASSET_VERSION')) }}"></script>
{% block extra_scripts %}{% endblock %}
</body>
</html>