{% extends "base.html" %}
{% block content %}
<h2 class="play-title">{{ 'Daily ' if daily else '' }}{{ mode|capitalize }} â€” Word Search</h2>
{% if category %}<div class="play-theme">
  Theme: <strong>{{ category.replace('_',' ').title() }}</strong>
</div>{% endif %}

<div id="meta"
     data-mode="{{mode}}"
     data-daily="{{1 if daily else 0}}"
     data-category="{{category or ''}}"
     data-hints-max="{{ config.get('HINTS_PER_PUZZLE', 3) }}"
     data-puzzle-id="{{ puzzle.puzzle_id if puzzle else '' }}">
</div>

<div class="play-container">
  <div class="play-header">
    <a class="btn play-back-link" href="{{ url_for('core.index') }}">Back to Menu</a>
    <div id="timer" class="play-timer" style="display: none;"></div>
  </div>

  <div class="play-game-card">
    <div class="play-game-content">
      <div id="grid" class="play-grid"></div>
      <div class="play-words-section">
        <h3>Find these words</h3>
        <div id="wordlist" class="play-word-list"></div>
        <button id="finishBtn" class="btn" style="margin-top: 10px;" disabled>Finish Game</button>
      </div>
    </div>
  </div>

  <div id="celebration" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 1000;">
    <h2>ðŸŽ‰ Congratulations!</h2>
    <p>You found all the words!</p>
    <button onclick="document.getElementById('celebration').style.display='none'" class="btn">Close</button>
  </div>

  <div id="completionDialog" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
    <div style="background: linear-gradient(135deg, #663399, #9966cc); color: white; padding: 30px; border-radius: 16px; border: 3px solid white; box-shadow: 0 8px 32px rgba(0,0,0,0.4); text-align: center; max-width: 400px; margin: 20px;">
      <h2 style="margin: 0 0 10px 0; font-size: 24px;">ðŸŽ‰ Game Complete!</h2>
      <div id="completionStats" style="margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
        <p style="margin: 5px 0; font-size: 16px;" id="wordsFoundText">All words found!</p>
        <p style="margin: 5px 0; font-size: 14px; opacity: 0.9;" id="timeCompletedText">Time: --:--</p>
        <p style="margin: 5px 0; font-size: 14px; opacity: 0.9;" id="scoreText">Score saved!</p>
      </div>
      <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <button id="playAgainBtn" class="btn primary" style="flex: 1; min-width: 120px;">Play Again</button>
        <button id="backToMenuBtn" class="btn secondary" style="flex: 1; min-width: 120px;">Main Menu</button>
      </div>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/play.js') }}?v=20250918b"></script>
{% endblock %}